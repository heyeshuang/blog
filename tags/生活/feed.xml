<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>生活 on 林中阴影</title><link>https://blog.heysh.xyz/tags/%E7%94%9F%E6%B4%BB/</link><description>Recent content in 生活 on 林中阴影</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>&amp;copy;贺叶霜，&lt;a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA&lt;/a></copyright><lastBuildDate>Fri, 21 Jan 2022 19:43:45 +0800</lastBuildDate><atom:link href="https://blog.heysh.xyz/tags/%E7%94%9F%E6%B4%BB/feed.xml" rel="self" type="application/rss+xml"/><item><title>获取招商信用卡账单的另一种方法</title><link>https://blog.heysh.xyz/2022/01/21/new-method-to-get-cmb-bill/</link><pubDate>Fri, 21 Jan 2022 19:43:45 +0800</pubDate><guid>https://blog.heysh.xyz/2022/01/21/new-method-to-get-cmb-bill/</guid><description>&lt;figure>
&lt;audio controls preload="metadata">
&lt;source src="th08_06.mp3" type="audio/mpeg">
&lt;/audio>
&lt;figcaption>&lt;h4>BGM: 懐かしき東方の血　～ Old World&lt;/h4>&lt;/figcaption>
&lt;/figure>
&lt;blockquote>
&lt;p>按：&lt;/p>
&lt;p>最近招商银行不再给我发送EML格式的电子邮件账单了，取而代之的是邮件中的PDF附件，&lt;em>仅供人类阅读&lt;/em>，基本上没有办法进行自动处理。于是我故伎重施，试图在IE驱动的网上银行中找到账单，可是找到的却只是用electron包裹的丑陋电子银行客户端，理所应当地不提供下载服务。&lt;/p>
&lt;p>紧紧关闭的大门前，仅有一点点光芒透出来：招行的手机版网站仍然可用。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>招商银行信用卡官方网站在&lt;a href="https://xyk.cmbchina.com/credit-express/bill">https://xyk.cmbchina.com/credit-express/bill&lt;/a>。为了假装自己是在用手机访问，请使用Chrome浏览器&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>，开启开发者工具，显示设备工具栏（Ctrl+Shift+M），并模拟iPhone或者其他手机。
&lt;img src="%E7%99%BB%E5%BD%95.png" alt="登录的状态">&lt;/li>
&lt;li>如果能够顺利登录的话，大概能够看见自己的欠款金额了。这个网站采用React+Mobx开发，与后端通过&lt;code>fetch&lt;/code>通信，可能也有某种加密。只是下载网站上的数据的话，也许不能算犯&lt;code>破坏计算机信息系统罪&lt;/code>。
&lt;img src="%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2.png" alt="用户界面">&lt;/li>
&lt;li>点击“历史账单”；&lt;/li>
&lt;li>点击开发者工具中的“应用”tab；&lt;/li>
&lt;li>点击&lt;code>帧&lt;/code>-&lt;code>XHR和fetch&lt;/code>-&lt;code>getService.json&lt;/code>；&lt;/li>
&lt;li>右击右侧的&lt;code>respCode&lt;/code>，选择复制值；
&lt;img src="%E4%BF%9D%E5%AD%98.png" alt="保存">&lt;/li>
&lt;li>粘贴到一个&lt;code>cmb.json&lt;/code>内。&lt;/li>
&lt;/ul>
&lt;p>好的，我们已经获得了本月账单的JSON文件了。&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
大概长得像这样
&lt;/h4>
&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#309;font-weight:bold">&amp;#34;respCode&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;1000&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;respMsg&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;操作成功&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;data&amp;#34;&lt;/span>: {
&lt;span style="color:#309;font-weight:bold">&amp;#34;rmbBillInfo&amp;#34;&lt;/span>: {
&lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;9999.90&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleStart&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20211215&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleEnd&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;repaymentDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220202&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;minPayment&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;999.90&amp;#34;&lt;/span>
},
&lt;span style="color:#309;font-weight:bold">&amp;#34;dollarBillInfo&amp;#34;&lt;/span>: {
&lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0.00&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleStart&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20211215&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleEnd&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;repaymentDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220202&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;minPayment&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0.00&amp;#34;&lt;/span>
},
&lt;span style="color:#309;font-weight:bold">&amp;#34;detail&amp;#34;&lt;/span>: [
{
&lt;span style="color:#309;font-weight:bold">&amp;#34;billId&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billType&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;DetailBill&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220113180009&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;billMonth&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;202201&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;org&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;999&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;transactionAmount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;88.88&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;88.88&amp;#34;&lt;/span>, &lt;span style="color:#09f;font-style:italic">//实际的RMB入账
&lt;/span>&lt;span style="color:#09f;font-style:italic">&lt;/span> &lt;span style="color:#309;font-weight:bold">&amp;#34;description&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;财付通&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;postingDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;location&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;CN&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;totalStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;currentStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;remainingStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;transactionType&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;消费&amp;#34;&lt;/span>,
&lt;span style="color:#309;font-weight:bold">&amp;#34;cardNo&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;6666&amp;#34;&lt;/span>
},]
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;p>接下来，可以使用你喜欢的方法对账单进行处理了。对于beancount，我写的importer放在&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">这里&lt;/a>。&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>Firefox似乎对所谓的“安全”键盘存在一些兼容性问题。&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item></channel></rss>