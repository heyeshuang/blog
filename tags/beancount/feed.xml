<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Beancount on 林中阴影</title><link>https://blog.heysh.xyz/tags/beancount/</link><description>Recent content in Beancount on 林中阴影</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>&amp;copy;贺叶霜，&lt;a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA&lt;/a></copyright><lastBuildDate>Fri, 21 Jan 2022 19:43:45 +0800</lastBuildDate><atom:link href="https://blog.heysh.xyz/tags/beancount/feed.xml" rel="self" type="application/rss+xml"/><item><title>获取招商信用卡账单的另一种方法</title><link>https://blog.heysh.xyz/2022/01/21/new-method-to-get-cmb-bill/</link><pubDate>Fri, 21 Jan 2022 19:43:45 +0800</pubDate><guid>https://blog.heysh.xyz/2022/01/21/new-method-to-get-cmb-bill/</guid><description>&lt;figure>
&lt;audio controls preload="metadata">
&lt;source src="th08_06.mp3" type="audio/mpeg">
&lt;/audio>
&lt;figcaption>&lt;h4>BGM: 懐かしき東方の血　～ Old World&lt;/h4>&lt;/figcaption>
&lt;/figure>
&lt;blockquote>
&lt;p>按：&lt;/p>
&lt;p>最近招商银行不再给我发送EML格式的电子邮件账单了，取而代之的是邮件中的PDF附件，&lt;em>仅供人类阅读&lt;/em>，基本上没有办法进行自动处理。于是我故伎重施，试图在IE驱动的网上银行中找到账单，可是找到的却只是用Electron包裹的丑陋电子银行客户端，理所应当地不提供下载服务。&lt;/p>
&lt;p>紧紧关闭的大门前，仅有一点点光芒透出来：招行的手机版网站仍然可用。&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>招商银行信用卡官方网站在&lt;a href="https://xyk.cmbchina.com/credit-express/bill">https://xyk.cmbchina.com/credit-express/bill&lt;/a>。为了假装自己是在用手机访问，请使用Chrome浏览器&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>，开启开发者工具，显示设备工具栏（Ctrl+Shift+M），并模拟iPhone或者其他手机。
&lt;img src="%E7%99%BB%E5%BD%95.png" alt="登录的状态">&lt;/li>
&lt;li>如果能够顺利登录的话，大概能够看见自己的欠款金额了。这个网站采用React+Mobx开发，与后端通过&lt;code>fetch&lt;/code>通信，可能也有某种加密。只是下载网站上的数据的话，也许不能算犯&lt;code>破坏计算机信息系统罪&lt;/code>。
&lt;img src="%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2.png" alt="用户界面">&lt;/li>
&lt;li>点击“历史账单”；&lt;/li>
&lt;li>点击开发者工具中的“应用”tab；&lt;/li>
&lt;li>点击&lt;code>帧&lt;/code>-&lt;code>XHR和fetch&lt;/code>-&lt;code>getService.json&lt;/code>；&lt;/li>
&lt;li>右击右侧的&lt;code>respCode&lt;/code>，选择复制值；
&lt;img src="%E4%BF%9D%E5%AD%98.png" alt="保存">&lt;/li>
&lt;li>粘贴到一个&lt;code>cmb.json&lt;/code>内。&lt;/li>
&lt;/ul>
&lt;p>好的，我们已经获得了本月账单的JSON文件了。&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
大概长得像这样
&lt;/h4>
&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;respCode&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;1000&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;respMsg&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;操作成功&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;data&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;rmbBillInfo&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;9999.90&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleStart&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20211215&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleEnd&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;repaymentDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220202&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;minPayment&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;999.90&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;dollarBillInfo&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0.00&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleStart&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20211215&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billCycleEnd&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;repaymentDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220202&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;minPayment&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0.00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;detail&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billId&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;0&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billType&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;DetailBill&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220113180009&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;billMonth&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;202201&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;org&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;999&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;transactionAmount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;88.88&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;amount&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;88.88&amp;#34;&lt;/span>, &lt;span style="color:#09f;font-style:italic">//实际的RMB入账
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#09f;font-style:italic">&lt;/span> &lt;span style="color:#309;font-weight:bold">&amp;#34;description&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;财付通&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;postingDate&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;20220114&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;location&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;CN&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;totalStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;currentStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;remainingStages&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;transactionType&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;消费&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#309;font-weight:bold">&amp;#34;cardNo&amp;#34;&lt;/span>: &lt;span style="color:#c30">&amp;#34;6666&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;p>接下来，可以使用你喜欢的方法对账单进行处理了。对于beancount，我写的importer放在&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">这里&lt;/a>。&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>Firefox似乎对所谓的“安全”键盘存在一些兼容性问题。&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item><item><title>Beancount试用,半年后</title><link>https://blog.heysh.xyz/2019/11/07/netease-youqian-with-beancount/</link><pubDate>Thu, 07 Nov 2019 21:58:22 +0800</pubDate><guid>https://blog.heysh.xyz/2019/11/07/netease-youqian-with-beancount/</guid><description>&lt;p>自从2017年开始，我一直使用 &lt;em>网易有钱&lt;/em> 记账。不得不说，如果像某落水狗讲的那样，“中国人不在乎隐私”的话，这确实是一个非常好用的APP，下载账单、导入数据一气呵成，连余额宝的利息都能够算得分毫不差——&lt;/p>
&lt;p>直到最近，大概是骂挨得太多，或是界面里终于塞不下更多广告，这个APP①用“维护中”挡住了所有同步按钮，并且②停止了维护。&lt;/p>
&lt;p>用8元买回了本属于自己的数据后，我想起之前听说过的&lt;a href="https://www.byvoid.com/zht/blog/beancount-bookkeeping-1">Beancount&lt;/a>。于是，我给那些数据找到了一些新用途。&lt;/p>
&lt;h2 id="冷启动">冷启动&lt;/h2>
&lt;p>首先，我阅读了&lt;a href="https://yuchi.me/post/beancount-intro/">这篇博文&lt;/a>，搭起了Beancount。接着，我又写了一些其它的&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">脚本&lt;/a>。&lt;/p>
&lt;h3 id="自动建立收支账户">自动建立收支账户&lt;/h3>
&lt;p>之前的理财软件大多会提供一些初始分类，比如说mint所用的类别列表在&lt;a href="https://www.mint.com/mint-categories">这里&lt;/a>。
对于本人&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>之前的账本，有过记录的大概是这样几类：&lt;/p>
&lt;p>&lt;code>{'交通,', '交通,打车', '交通,机票', '交通,火车', '人情,', '住房,', '住房,家具', '住房,家纺', '住房,物业水电', '住房,装修', '其他,', '医疗,', '医疗,药品', '娱乐,', '娱乐,电影', '投资亏损,', '文教,', '文教,书刊', '文教,文具', '旅行,', '旅行,景点门票', '旅行,酒店', '汽车,', '购物,', '购物,数码', '购物,日用', '购物,玩具', '购物,电器', '购物,美妆', '购物,运动用品', '购物,鞋服', '购物,饰品', '通讯,', '通讯,话费', '零食烟酒,', '零食烟酒,水果', '零食烟酒,烟酒', '零食烟酒,茶水', '零食烟酒,零食', '零食烟酒,饮料', '餐饮,', '餐饮,三餐', '餐饮,食材'}&lt;/code>&lt;/p>
&lt;p>对这些分类，利用人工&lt;del>智能&lt;/del>，为每一项建立了对应的&lt;code>account&lt;/code>，形成了一个&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers/blob/master/importers/youqian/youqianDict.py">dict&lt;/a>。&lt;/p>
&lt;p>如果你已经下载了&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">beancount-homemade-importers&lt;/a>，你可以用里面的&lt;code>importers/ youqian/accountInit.py&lt;/code>来自动建立这些&lt;code>accounts&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>python importers/youqian/accountInit.py &amp;gt; New_Accounts.bean
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#09f;font-style:italic"># 或：如果之前已经建立了一些账户的话&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python importers/youqian/accountInit.py Existing_Accounts.bean &amp;gt; New_Accounts.bean
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="导入网易有钱的收入支出数据">导入网易有钱的收入、支出数据&lt;/h3>
&lt;p>Beancount的&lt;a href="https://docs.google.com/document/d/11EwQdujzEo2cxqaF5PgxCEZXWfKKQCYSMfdJowp_1S8/edit#">文档&lt;/a>里已经对导入脚本进行了比较详细的说明。从&lt;a href="https://bitbucket.org/blais/beancount/src/tip/examples/ingest/office/importers/utrade/">这个例子&lt;/a>开始，基本上只要实现几个函数就行。&lt;/p>
&lt;p>在&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">beancount-homemade-importers&lt;/a>中，我写了一个简单的网易有钱导入脚本。在使用之前，需要用excel把默认的&lt;code>xlsx&lt;/code>格式转换为&lt;code>收入.csv&lt;/code>和&lt;code>支出.csv&lt;/code>。&lt;/p>
&lt;p>之后，使用&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>bean-extract importers/youqian/youqian_expense.import documents.tmp/支出.csv &amp;gt; 支出.bean
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bean-extract importers/youqian/youqian_income.import documents.tmp/收入.csv &amp;gt; 收入.bean
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>来导入。&lt;/p>
&lt;h2 id="自动记账">自动记账&lt;/h2>
&lt;p>写下这个标题是在2020年6月。在使用beancount半年之后，账本一共增加了270条内容，所需的时间每月不超过1小时。&lt;/p>
&lt;p>&lt;img src="%E6%9D%A1%E7%9B%AE.png" alt="">&lt;/p>
&lt;h3 id="梳理资金的流向">梳理资金的流向&lt;/h3>
&lt;p>作为一个单身工薪族，我的&lt;del>主要&lt;/del>全部收入来自于工资，在经过一些卡片后，从微信、支付宝和其他地方流走。&lt;/p>
&lt;p>&lt;img src="mermaid-diagram.svg" alt="用mermaid画的流程图">&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
(这张图是用mermaid画的，这里是源代码)
&lt;/h4>
&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>graph LR;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> linkStyle default interpolate basis
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> subgraph one [开销]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> A([支付宝]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> B([微信]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> G([&amp;#34;京东、刷卡&amp;#34;]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> H([理财]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> end
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> subgraph two [收入]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C[工商银行];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> end
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> D[农业银行];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> E([中国银行]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> F([招商银行]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> E --&amp;gt; H
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> E &amp;amp; F --&amp;gt; A &amp;amp; B
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C --&amp;gt; E &amp;amp; D &amp;amp; F
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> F --&amp;gt; G
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> classDef auto fill:#9ACFBF
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> class B,E,F auto
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;p>其中，有一些银行卡（比如图中的农业银行）每月的转账记录不超过2条，这时候只要手工敲上几行就可以了。对于另外的、日常生活的花费，手动记录带来了大量时间的浪费。这时候，找到流动的枢纽，并对它们的账单进行批量处理，就可以从重复劳动中解放出来。对于我来说，要进行批量处理的节点是&lt;code>中国银行&lt;/code>，&lt;code>招商银行&lt;/code>和&lt;code>微信&lt;/code>。&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>&lt;/p>
&lt;h3 id="写一些脚本">写一些脚本&lt;/h3>
&lt;p>所以，我写了中国银行、招商银行和微信钱包对账单的导入脚本。Beancount拥有比较强大的导入功能，对于简单的、CSV格式的账单文件，只要在自带的&lt;code>beancount.ingest.importers.csv.importer&lt;/code>上&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers/blob/master/importers/boc.import">稍作修改&lt;/a>就可以了；对于其它较为复杂的账单，可以自行扩展&lt;code>ImporterProtocol&lt;/code>的子类，在&lt;a href="https://docs.google.com/document/d/11EwQdujzEo2cxqaF5PgxCEZXWfKKQCYSMfdJowp_1S8/edit#heading=h.z153vh2ll6ix">官方文档&lt;/a>中有较为详细的说明。&lt;/p>
&lt;p>另外，我还发现了&lt;a href="https://github.com/beancount/smart_importer">smart_importer&lt;/a>，只要简单地增加hook，就可以给导入脚本增加更好的去重、智能猜测分类等更帅气的功能。&lt;/p>
&lt;h3 id="在每个账单日运行一次">在每个账单日运行一次&lt;/h3>
&lt;p>在账单目录下，我建立了一个&lt;code>TODO&lt;/code>文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>自动导入微信、中国银行和招商（账单日）
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>手动导入工行和农行
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>因为微信的账单信息比较多，我一般先从它开始。每月信用卡的账单日，下载微信钱包对账单，然后运行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>bean-extract importers/wechat.import documents.tmp/微信支付账单.csv -f main.bean &amp;gt; temp.bean
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中，&lt;code>-f&lt;/code>用来为&lt;code>smart_importer&lt;/code>提供学习素材。&lt;/p>
&lt;p>接下来打开&lt;code>temp.bean&lt;/code>，检查人工&lt;del>智障&lt;/del>智能补充的分类条目有没有什么问题。（大概率问题很多，每个月大部分的时间会花费在这里。）&lt;/p>
&lt;p>之后，将&lt;code>temp.bean&lt;/code>重命名为一个有意义的名字，并在&lt;code>main.bean&lt;/code>中&lt;code>import&lt;/code>。接下來对银行账户的导入过程中，&lt;code>smart_importer&lt;/code>会自动去除重复账单。&lt;/p>
&lt;p>在上面的工作都完成以后，本月的账单也只剩下几条漏网之鱼了。把它们（手动）补充，并用&lt;code>balance&lt;/code>命令检查。&lt;/p>
&lt;h3 id="并养成记账的好习惯">并养成“记账的好习惯”&lt;/h3>
&lt;p>在某些问答网站上，在“相见恨晚的习惯”列表，记账大概能排在top10的位置；同时，在“半途而废的习惯”里，位置大概也在附近。原因并不仅仅是“缺乏自制力”，而是手动记账花费了太多时间，而效果并不是立竿见影的。在付出和反馈不成比例时，放弃就成了唯一的选择。&lt;/p>
&lt;p>如果每个月只要十几分钟就可以获得成就感，习惯也就自然地养成了。&lt;/p>
&lt;h2 id="又及">又及&lt;/h2>
&lt;blockquote>
&lt;p>我跟你港，这次的内容超适合作Python教程的，还能顺便学英语！只要学会了这个，年薪百万不是梦！&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>现在诚征 100 个&lt;del>凯子&lt;/del>幸运读者给我打钱，我的支付宝是：……&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>呃，对不起。&lt;/p>
&lt;/blockquote>
&lt;p>以上不代表博主观点。&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>一个普通的、抠抠索索的中青年男性，未婚，不修边幅，被阳光照到会燃烧。&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2" role="doc-endnote">
&lt;p>细心的读者可能会注意到，我并没有将支付宝也列入进来，即使和微信的地位相似。这是由于支付宝的账单并不能显示付款账户。通过余额宝和通过信用卡支付，在对账单上没有明确的区分，这会给之后的条目合并造成困难。在开始用beancount之后，因为手动记录太麻烦，我很少用支付宝付款。(update 220426：最近听说支付宝手机版能够看到付款账户，之后可以试试)&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item></channel></rss>