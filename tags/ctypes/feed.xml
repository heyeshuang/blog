<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Ctypes on 林中阴影</title><link>https://blog.heysh.xyz/tags/ctypes/</link><description>Recent content in Ctypes on 林中阴影</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>&amp;copy;贺叶霜，&lt;a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA&lt;/a></copyright><lastBuildDate>Wed, 06 Sep 2017 19:46:55 +0800</lastBuildDate><atom:link href="https://blog.heysh.xyz/tags/ctypes/feed.xml" rel="self" type="application/rss+xml"/><item><title>关于那个IME helper</title><link>https://blog.heysh.xyz/2017/09/06/gossip_about_ime_helper/</link><pubDate>Wed, 06 Sep 2017 19:46:55 +0800</pubDate><guid>https://blog.heysh.xyz/2017/09/06/gossip_about_ime_helper/</guid><description>&lt;p>&lt;del>昨天&lt;/del>前天我用鸟语写了一篇贼 &lt;em>正经&lt;/em> 的&lt;a href="https://blog.heysh.xyz/2017/09/05/atom-vim-mode-auto-switch-ime/">说明&lt;/a>，今天，我准备稍微介绍一下那里面的&lt;code>IME helper&lt;/code>。&lt;/p>
&lt;p>正如之前所说，那东西是为了配合atom插件自动开关输入法用的。问题明确、思路清晰，google一下肯定有人做过……才怪呢&lt;/p>
&lt;p>嗯，这种需求，我听过一个叫AHK的语言……&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-fallback" data-lang="fallback">&lt;span style="display:flex;">&lt;span>;来自https://github.com/lspcieee/lspcieee_ahk/blob/master/IME.ahk
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>;没有任何要黑别人的意思，将来报道出了偏差，你们（下略）
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>setChineseLayout(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ;发送中文输入法切换快捷键，请根据实际情况设置。
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send {Ctrl Down}{Shift}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send {Ctrl Down},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send {Ctrl Down}{Shift}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send {Ctrl Down},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send {Ctrl Up}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>哇这语言真的是发送快捷键的哦！就没有什么更高级的方法吗？快捷键在win10里可是改了啊( &amp;gt;﹏&amp;lt;。)&lt;/p>
&lt;p>然后就愉快地决定用 Python+ctypes 干这种脏活了，然后发现：windows API真是太难写了！一个更改输入法有4种写法！而且都不能用！&lt;/p>
&lt;p>最后居然还是抄的&lt;a href="http://www.ahk8.com/thread-3751.html?highlight=%E8%BE%93%E5%85%A5%E6%B3%95">AHK社区的东西&lt;/a>……亏我还像白痴一样疯狂翻MSDN……&lt;/p>
&lt;p>另外，pyinstaller生成的单文件exe&lt;del>跑得不够快&lt;/del>用起来有延迟，大概是因为解压吧……&lt;/p></description></item></channel></rss>