<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>网易有钱 on 林中阴影</title><link>https://blog.heysh.xyz/tags/%E7%BD%91%E6%98%93%E6%9C%89%E9%92%B1/</link><description>Recent content in 网易有钱 on 林中阴影</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>&amp;copy;贺叶霜，&lt;a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA&lt;/a></copyright><lastBuildDate>Thu, 07 Nov 2019 21:58:22 +0800</lastBuildDate><atom:link href="https://blog.heysh.xyz/tags/%E7%BD%91%E6%98%93%E6%9C%89%E9%92%B1/feed.xml" rel="self" type="application/rss+xml"/><item><title>Beancount试用</title><link>https://blog.heysh.xyz/2019/11/07/netease-youqian-with-beancount/</link><pubDate>Thu, 07 Nov 2019 21:58:22 +0800</pubDate><guid>https://blog.heysh.xyz/2019/11/07/netease-youqian-with-beancount/</guid><description>&lt;p>自从2017年开始，我一直使用 &lt;em>网易有钱&lt;/em> 记账。不得不说，如果像某落水狗讲的那样，“中国人不在乎隐私”的话，这确实是一个非常好用的APP，下载账单、导入数据一气呵成，连余额宝的利息都能够算得分毫不差——&lt;/p>
&lt;p>直到最近，大概是骂挨得太多，或是界面里终于塞不下更多广告，这个APP①用“维护中”挡住了所有同步按钮，并且②停止了维护。&lt;/p>
&lt;p>用8元买回了本属于自己的数据后，我想起之前听说过的&lt;a href="https://www.byvoid.com/zht/blog/beancount-bookkeeping-1">Beancount&lt;/a>。于是，我给那些数据找到了一些新用途。&lt;/p>
&lt;p>首先，我阅读了&lt;a href="https://yuchi.me/post/beancount-intro/">这篇博文&lt;/a>，搭起了Beancount。接着，我又写了一些其它的&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">脚本&lt;/a>。&lt;/p>
&lt;h2 id="自动建立收支账户">自动建立收支账户&lt;/h2>
&lt;p>之前的理财软件大多会提供一些初始分类，比如说mint所用的类别列表在&lt;a href="https://www.mint.com/mint-categories">这里&lt;/a>。
对于本人&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>之前的账本，有过记录的大概是这样几类：&lt;/p>
&lt;p>&lt;code>{'交通,', '交通,打车', '交通,机票', '交通,火车', '人情,', '住房,', '住房,家具', '住房,家纺', '住房,物业水电', '住房,装修', '其他,', '医疗,', '医疗,药品', '娱乐,', '娱乐,电影', '投资亏损,', '文教,', '文教,书刊', '文教,文具', '旅行,', '旅行,景点门票', '旅行,酒店', '汽车,', '购物,', '购物,数码', '购物,日用', '购物,玩具', '购物,电器', '购物,美妆', '购物,运动用品', '购物,鞋服', '购物,饰品', '通讯,', '通讯,话费', '零食烟酒,', '零食烟酒,水果', '零食烟酒,烟酒', '零食烟酒,茶水', '零食烟酒,零食', '零食烟酒,饮料', '餐饮,', '餐饮,三餐', '餐饮,食材'}&lt;/code>&lt;/p>
&lt;p>对这些分类，利用人工&lt;del>智能&lt;/del>，为每一项建立了对应的&lt;code>account&lt;/code>，形成了一个&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers/blob/master/importers/youqian/youqianDict.py">dict&lt;/a>。&lt;/p>
&lt;p>如果你已经下载了&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">beancount-homemade-importers&lt;/a>，你可以用里面的&lt;code>importers/ youqian/accountInit.py&lt;/code>来自动建立这些&lt;code>accounts&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python importers/youqian/accountInit.py &amp;gt; New_Accounts.bean
&lt;span style="color:#09f;font-style:italic"># 或：如果之前已经建立了一些账户的话&lt;/span>
python importers/youqian/accountInit.py Existing_Accounts.bean &amp;gt; New_Accounts.bean
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="导入网易有钱的收入支出数据">导入网易有钱的收入、支出数据&lt;/h2>
&lt;p>Beancount的&lt;a href="https://docs.google.com/document/d/11EwQdujzEo2cxqaF5PgxCEZXWfKKQCYSMfdJowp_1S8/edit#">文档&lt;/a>里已经对导入脚本进行了比较详细的说明。从&lt;a href="https://bitbucket.org/blais/beancount/src/tip/examples/ingest/office/importers/utrade/">这个例子&lt;/a>开始，基本上只要实现几个函数就行。&lt;/p>
&lt;p>在&lt;a href="https://github.com/heyeshuang/beancount-homemade-importers">beancount-homemade-importers&lt;/a>中，我写了一个简单的网易有钱导入脚本。在使用之前，需要用excel把默认的&lt;code>xlsx&lt;/code>格式转换为&lt;code>收入.csv&lt;/code>和&lt;code>支出.csv&lt;/code>。&lt;/p>
&lt;p>之后，使用&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-fallback" data-lang="fallback">bean-extract importers/youqian/youqian_expense.import documents.tmp/支出.csv &amp;gt; 支出.bean
bean-extract importers/youqian/youqian_income.import documents.tmp/收入.csv &amp;gt; 收入.bean
&lt;/code>&lt;/pre>&lt;/div>&lt;p>来导入。&lt;/p>
&lt;p>另外，我还写了中国银行、招商银行和微信钱包对账单的导入脚本，当然基本上是从&lt;a href="https://yuchi.me/post/beancount-intro/">这里&lt;/a>抄袭的。&lt;/p>
&lt;hr>
&lt;p>又及：&lt;/p>
&lt;blockquote>
&lt;p>我跟你港，这次的内容超适合作Python教程的，还能顺便学英语！只要学会了这个，年薪百万不是梦！&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>现在诚征 100 个&lt;del>凯子&lt;/del>幸运读者给我打钱，我的支付宝是：……&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>呃，对不起。&lt;/p>
&lt;/blockquote>
&lt;p>以上不代表博主观点。&lt;/p>
&lt;hr>
&lt;p>来自2019-11-20的更新：&lt;/p>
&lt;p>我又仔细梳理了一下自己的花销，发现只要导入微信账单、一张信用卡（招商）和一张借记卡（中行）就可以覆盖绝大多数消费情况；另外，我还发现了&lt;a href="https://github.com/beancount/smart_importer">smart_importer&lt;/a>，只要简单地增加hook，就可以给导入脚本增加更好的去重、智能猜测分类等更帅气的功能。&lt;/p>
&lt;p>根据这些，在刚才我更新了自己使用的脚本，基本上可以覆盖自己的需求了&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>。&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>一个普通的、抠抠索索的中青年男性，未婚，不修边幅，被阳光照到会燃烧。 &lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2" role="doc-endnote">
&lt;p>除了还要手动把中国银行的账单改成UTF-8 &lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item></channel></rss>