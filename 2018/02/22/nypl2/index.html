<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>林中阴影 | 这次是纽约公共图书馆……的第二天！</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.86.1">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link href=/dist/app.css rel=stylesheet>
<link rel="shortcut icon" href=img/favicon.png type=image/png>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-40522664-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=stylesheet href=https://blog.heysh.xyz/lib/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous>
<script defer src=https://blog.heysh.xyz/lib/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://blog.heysh.xyz/lib/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script>
<script>(function(f,b){var c=document,d='script',a=c.createElement(d),e=c.getElementsByTagName(d)[0];a.src=f,b&&a.addEventListener('load',function(a){b(a)}),e.parentNode.insertBefore(a,e)})('https://blog.heysh.xyz/lib/pangu.min.js',function(){pangu.spacingPage()})</script>
<style type=text/css media="screen, print">@font-face{font-family:fancytitlefont;font-style:normal;font-display:swap;src:url(https://blog.heysh.xyz/fonts/%E6%9D%A8%E4%BB%BB%E4%B8%9C%E7%AB%B9%E7%9F%B3%E4%BD%93-Light.woff2)format('woff2'),url(https://blog.heysh.xyz/fonts/%E6%9D%A8%E4%BB%BB%E4%B8%9C%E7%AB%B9%E7%9F%B3%E4%BD%93-Light.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:300;font-display:swap;src:local('Noto Serif CJK SC Light'),local('NotoSerifCJK-Light'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff2)format('woff2'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:400;font-display:swap;src:local('Noto Serif CJK SC'),local('NotoSerifCJK-Regular'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff2)format('woff2'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:500;font-display:swap;src:local('Noto Serif CJK SC Medium'),local('NotoSerifCJK-Medium'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff2)format('woff2'),url(https://blog.heysh.xyz/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff)format('woff')}</style>
</head>
<body class="bg-gray-100 text-gray-700 font-sans">
<div class="p-6 sm:p-10 md:p-16 flex flex-wrap">
<header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl">
<div class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2">
<div>
<h2>
<a href=https://blog.heysh.xyz/ title=林中阴影 class="heading font-cursive icon">林中阴影</a>
</h2>
</div>
<h1 class=pt-2>这次是纽约公共图书馆……的第二天！</h1>
<div class="flex flex-wrap justify-end pt-2"><div class="md:flex-grow-0 font-light">
<a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href=/categories/%E6%8A%98%E8%85%BE>折腾</a>
&nbsp;&nbsp;
<a class="post-taxonomy-tag text-eucalyptus-500" href=/tags/%E7%BA%BD%E7%BA%A6%E5%85%AC%E4%BC%97%E5%9B%BE%E4%B9%A6%E9%A6%86>纽约公众图书馆</a>&nbsp;/
<a class="post-taxonomy-tag text-eucalyptus-500" href=/tags/%E7%B4%A0%E6%9D%90>素材</a>
</div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime=2018-02-22T16:03:59+08:00>2018-2-22 16:03</time>
</div>
<hr>
</div>
</header>
<main role=main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4">
<article>
<section class="mx-auto content">
<div class=c-rich-text><blockquote>
<p>（精神上）坐在图书馆里，我想：能不能把这些旧书借走呢？</p>
</blockquote>
<p>当然是可以的！贴心的图书管理员已经提供了API接口：<a href=http://api.repo.nypl.org/>http://api.repo.nypl.org/</a>，申请账号之后，就可以做各种各样的事了~</p>
<p>当然，如果只是想下片的话，用<a href=https://github.com/NYPL-publicdomain/api-client>digital-collections</a>可能会更简单一些：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>digital-collections -t API_TOKEN -s UUID -o OUTPUT.json
</code></pre></div><p>其中，<code>API_TOKEN</code>在申请账号以后会得到一个；在你想要下载的专辑（<a href="https://digitalcollections.nypl.org/collections/a-curious-herbal-containing-five-hundred-cuts-of-the-most-useful-plants-which#/?tab=about&scroll=50">比如这个</a>）下面，可以看到<code>UUID</code>；运行这条命令之后，图片的信息列表会保存在<code>OUTPUT.json</code>里。</p>
<figure><img src=/nypl/clip.png><figcaption>
<h4>对，就是那个Universal Unique Identifier</h4>
</figcaption>
</figure>
<p>之后，获得的json文件大概像是这样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
	<span style=color:#309;font-weight:700>&#34;uuid&#34;</span>: <span style=color:#c30>&#34;510d47dd-c1f5-a3d9-e040-e00a18064a99&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;imageLinks&#34;</span>: {
		<span style=color:#309;font-weight:700>&#34;imageLink&#34;</span>: [
			<span style=color:#c30>&#34;http://images.nypl.org/index.php?id=1125721&amp;t=w&amp;download=1&amp;suffix=510d47dd-c1f5-a3d9-e040-e00a18064a99.001&#34;</span>,
			<span style=color:#c30>&#34;http://images.nypl.org/index.php?id=1125721&amp;t=r&amp;download=1&amp;suffix=510d47dd-c1f5-a3d9-e040-e00a18064a99.001&#34;</span>,
			<span style=color:#c30>&#34;http://images.nypl.org/index.php?id=1125721&amp;t=t&amp;download=1&amp;suffix=510d47dd-c1f5-a3d9-e040-e00a18064a99.001&#34;</span>,
			<span style=color:#c30>&#34;http://images.nypl.org/index.php?id=1125721&amp;t=b&amp;download=1&amp;suffix=510d47dd-c1f5-a3d9-e040-e00a18064a99.001&#34;</span>,
			<span style=color:#c30>&#34;http://images.nypl.org/index.php?id=1125721&amp;t=f&amp;download=1&amp;suffix=510d47dd-c1f5-a3d9-e040-e00a18064a99.001&#34;</span>
		]
	},
	<span style=color:#309;font-weight:700>&#34;apiUri&#34;</span>: <span style=color:#c30>&#34;http://api.repo.nypl.org/api/v1/items/mods/510d47dd-c1f5-a3d9-e040-e00a18064a99&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;typeOfResource&#34;</span>: <span style=color:#c30>&#34;still image&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;imageID&#34;</span>: <span style=color:#c30>&#34;1125721&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;sortString&#34;</span>: <span style=color:#c30>&#34;0000000001|0000000002|0000000001&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;itemLink&#34;</span>: <span style=color:#c30>&#34;http://digitalcollections.nypl.org/items/510d47dd-c1f5-a3d9-e040-e00a18064a99&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;highResLink&#34;</span>: <span style=color:#c30>&#34;http://link.nypl.org/7nC9VyT_TJWvGX9_H0mYBQ8&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;title&#34;</span>: <span style=color:#c30>&#34;Dandelion.&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;dateDigitized&#34;</span>: <span style=color:#c30>&#34;2016-08-04T04:53:12Z&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;rightsStatement&#34;</span>: <span style=color:#c30>&#34;The New York Public Library believes that this item is in the public domain under the laws of the United States, but did not make a determination as to its copyright status under the copyright laws of other countries. This item may not be in the public domain under the laws of other countries. Though not required, if you want to credit us as the source, please use the following statement, \&#34;From The New York Public Library,\&#34; and provide a link back to the item on our Digital Collections site. Doing so helps us track how our collection is used and helps justify freely releasing even more content in the future.&#34;</span>,
	<span style=color:#309;font-weight:700>&#34;rightsStatementURI&#34;</span>: <span style=color:#c30>&#34;http://rightsstatements.org/vocab/NoC-US/1.0/&#34;</span>
}
</code></pre></div><p>之后，只要下载<code>imageLink</code>就好了。我用了一个简单的python脚本来做这件事。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#09f;font-style:italic># 注意：这玩意没有经过测试，可能会爆炸</span>
<span style=color:#09f;font-style:italic># 啊对了，而且是python3.6</span>
<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>urllib.request</span> <span style=color:#069;font-weight:700>as</span> <span style=color:#0cf;font-weight:700>ur</span>
<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>json</span>
<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>os</span>

dir_name<span style=color:#555>=</span><span style=color:#c30>&#34;Himalayan_plants&#34;</span> <span style=color:#09f;font-style:italic>#可能要改这里……</span>
os<span style=color:#555>.</span>mkdir(dir_name)
<span style=color:#069;font-weight:700>with</span> <span style=color:#366>open</span>(<span style=color:#c30>&#34;OUTPUT.json&#34;</span>,<span style=color:#c30>&#34;r&#34;</span>) <span style=color:#069;font-weight:700>as</span> source: <span style=color:#09f;font-style:italic>#……还有这里</span>
    source_dict<span style=color:#555>=</span>json<span style=color:#555>.</span>load(source)

<span style=color:#069;font-weight:700>for</span> _i,_s <span style=color:#000;font-weight:700>in</span> <span style=color:#366>enumerate</span>(source_dict):
    file_name<span style=color:#555>=</span>dir_name<span style=color:#555>+</span><span style=color:#c30>&#34;/&#34;</span><span style=color:#555>+</span><span style=color:#366>str</span>(_i)<span style=color:#555>+</span><span style=color:#c30>&#34;.jpg&#34;</span>
    <span style=color:#069;font-weight:700>if</span> os<span style=color:#555>.</span>path<span style=color:#555>.</span>exists(file_name)<span style=color:#555>==</span><span style=color:#069;font-weight:700>False</span>:
        <span style=color:#069;font-weight:700>try</span>:
            ur<span style=color:#555>.</span>urlretrieve(_s[<span style=color:#c30>&#34;imageLinks&#34;</span>][<span style=color:#c30>&#34;imageLink&#34;</span>][<span style=color:#f60>0</span>],file_name)
        <span style=color:#069;font-weight:700>except</span> <span style=color:#c00;font-weight:700>Exception</span> <span style=color:#069;font-weight:700>as</span> e:
            <span style=color:#366>print</span>(_i)
            <span style=color:#366>print</span>(<span style=color:#366>str</span>(e))
</code></pre></div></div>
</section>
</article>
</main>
<aside role=contentinfo class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl">
<div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2">
<div class="md:max-w-xs flex flex-col md:items-end">
<ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col">
<li class="px-1 md:px-0">
<a href=/post/ title="归档 page">
归档
</a>
</li>
<li class="px-1 md:px-0">
<a href=/categories/ title="分类 page">
分类
</a>
</li>
<li class="px-1 md:px-0">
<a href=/tags/ title="标签 page">
标签
</a>
</li>
<li class="px-1 md:px-0">
<a href=/about/ title="关于 page">
关于
</a>
</li>
<li class="px-1 md:px-0">
<a href=/wallet/ title="云乞讨 page">
云乞讨
</a>
</li>
<li class="px-1 md:px-0">
<a href=/sentences/ title="内心戏 page">
内心戏
</a>
</li>
<li class="px-1 md:px-0">
<a href=https://heysh.xyz/ title="芽 page">
芽
</a>
</li>
<div id=fastSearch class=m-0>
<input id=searchInput type=text size=10 class="bg-gray-100 focus:outline-none border-b border-gray-100 focus:border-eucalyptus-300 md:text-right
placeholder-java-500 min-w-0 max-w-xxxs" placeholder=search>
<ul id=searchResults class="bg-gray-200 px-2 divide-y divide-gray-400">
</ul>
</div>
</ul>
<div class="flex flex-wrap-reverse md:justify-end content-end md:content-start justify-start items-start max-h-16">
<a href=https://github.com/heyeshuang target=_blank class="github icon pl-1 text-eucalyptus-400 hover:text-java-400" title="github link" rel=noopener aria-label="follow on github——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32.0 01-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 01.676-1.883c.752.27 1.261.735 1.947 1.588-.094-.117.34.427.433.539.19.227.33.365.44.438.204.137.587.196 1.15.14.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292-.218-.894-.185-1.975.302-3.192a1 1 0 01.63-.582c.081-.024.127-.035.208-.047.803-.123 1.937.17 3.415 1.096A11.731 11.731.0 0112 3.315c.912.0 1.818.104 2.684.308 1.477-.933 2.613-1.226 3.422-1.096.085.013.157.03.218.05a1 1 0 01.616.58c.487 1.216.52 2.297.302 3.19.691.936 1.058 2.045 1.058 3.293.0 3.757-1.674 5.665-4.642 6.392.125.415.19.879.19 1.38a300.492 300.492.0 01-.012 2.716 1 1 0 01-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446.005-.705c.005-.708.007-1.338.007-1.998.0-.697-.183-1.152-.425-1.36-.661-.57-.326-1.655.54-1.752 2.967-.333 4.337-1.482 4.337-4.66.0-.955-.312-1.744-.913-2.404a1 1 0 01-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 01-.833.135A9.626 9.626.0 0012 5.315c-.89.0-1.772.119-2.592.35a1 1 0 01-.83-.134c-.752-.507-1.374-.807-1.868-.947-.144.653-.073 1.194.092 1.607a1 1 0 01-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66.865.097 1.201 1.177.544 1.748-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 01-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z"/></g></svg>
</div>
</a>
<a href=https://twitter.com/heyeshuang target=_blank class="twitter icon pl-1 text-eucalyptus-400 hover:text-java-400" title="twitter link" rel=noopener aria-label="follow on twitter——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M15.3 5.55a2.9 2.9.0 00-2.9 2.847l-.028 1.575a.6.6.0 01-.68.583l-1.561-.212c-2.054-.28-4.022-1.226-5.91-2.799-.598 3.31.57 5.603 3.383 7.372l1.747 1.098a.6.6.0 01.034.993L7.793 18.17c.947.059 1.846.017 2.592-.131 4.718-.942 7.855-4.492 7.855-10.348.0-.478-1.012-2.141-2.94-2.141zm-4.9 2.81a4.9 4.9.0 018.385-3.355c.711-.005 1.316.175 2.669-.645-.335 1.64-.5 2.352-1.214 3.331.0 7.642-4.697 11.358-9.463 12.309-3.268.652-8.02-.419-9.382-1.841.694-.054 3.514-.357 5.144-1.55C5.16 15.7-.329 12.47 3.278 3.786c1.693 1.977 3.41 3.323 5.15 4.037 1.158.475 1.442.465 1.973.538z"/></g></svg>
</div>
</a>
</div>
<div class="text-sm text-gray-500 leading-tight a-gray">
&copy;贺叶霜，<a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh>CC BY-SA</a>
<br>
Built with Hugo and theme <a href=https://github.com/heyeshuang/hugo-theme-tokiwa>Tokiwa</a>. 538 words in this page.
</div>
</div>
</div>
</aside>
<footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2">
<hr class=double-line>
<div class="flex flex-wrap justify-between pb-2 leading-loose font-serif">
<a class=flex-grow-0 href=/2018/02/21/nypl/><svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"/></svg>
这次是纽约公共图书馆……
</a>
<a class=flex-grow-0 href=/2018/02/24/nypl3/>
这次是纽约公共图书馆……而且居然还有第三部分？
<svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"/></svg></a>
</div>
<div>
<div class="font-serif pb-2 flex align-start leading-loose">
<span class="heading pr-6 leading-loose">Related</span>
<span>
<a href=/2018/02/21/nypl/>这次是纽约公共图书馆……</a>
</span>
</div>
</div>
<hr>
<div class=pb-2>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//heysh.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<hr>
</footer>
<script src=/dist/app.js></script>
<script src=/lib/fuse.min.js></script>
<script src=/lib/fastsearch.js></script>
</div>
</body>
</html>